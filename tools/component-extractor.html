<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>The HTML5 Herald</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">

  <script>
    function collectDefs (node, defs, treeNode) {
      if (node.nodeName === '#text') {
        return
      }
      treeNode.nodeName = node.nodeName
      var re = /^url\(#(.*)\)/i;
      var attrs = []
      for (var attr of node.attributes) {
        var value = attr.value
        if (attr.name === 'xlink:href') {
          var id = value.substr(1)
          defs.add(id) 
          value = (idMap) => "'#' + " + idMap[id]
        } else if (attr.name === 'id' && node.nodeName === 'mask') {
          var id = attr.value
          defs.add(id) 
          value = (idMap) => idMap[id]
        } else {
          var found = value.match(re);
          if (found) {
            var id = found[1]
            value = (idMap) => '`url(#${' + idMap[id] +'})`'
            defs.add(id)
          }
        }

        attrs.push({
          name: attr.name,
          value
        })
      }
      treeNode.attrs = attrs

      var children = []
      for (var child of node.childNodes) {
        var childNode = {}
        collectDefs(child, defs, childNode)
        if (childNode.nodeName) {
          children.push(childNode)
        }
      }
      treeNode.childNodes = children
    }

    function convertDef (node, treeNode) {
      if (node.nodeName === '#text') {
        return
      }
      treeNode.nodeName = node.nodeName
      var attrs = []
      for (var attr of node.attributes) {
        var value = attr.value
        if (attr.name === 'id') {
          var id = attr.value
          value = (idMap) => idMap[id]
        }
        attrs.push({
          name: attr.name,
          value
        })
      }
      treeNode.attrs = attrs

      var children = []
      for (var child of node.childNodes) {
        var childNode = {}
        convertDef(child, childNode)
        if (childNode.nodeName) {
          children.push(childNode)
        }
      }
      treeNode.childNodes = children
    }

    function capitalizeFirstLetter(string) {
      return string.charAt(0).toUpperCase() + string.slice(1);
    }

    function outputNode(node, idMap) {
      var result = `<${node.nodeName} `
      var attrs = []
      for (var attr of node.attrs) {
        var { name, value } = attr
        var nameParts = name.split('-')
        if (nameParts.length > 1) {
          name = nameParts[0] + nameParts.slice(1).map(n => capitalizeFirstLetter(n))
        }
        var nameParts2 = name.split(':')
        if (nameParts2.length > 1) {
          name = nameParts2[0] + nameParts2.slice(1).map(n => capitalizeFirstLetter(n))
        }

        if (typeof value === 'function') {
          value = value(idMap)
          attrs.push(`${name}={${value}}`)
        } else {
          if (name === 'id' && value.startsWith('Top/_Resources/')) {
            return '{this.props.children}'
          }
          attrs.push(`${name}='${value}'`)
        }
      }
      result += attrs.join(' ') + '>'
      for (var child of node.childNodes) {
        result += outputNode(child, idMap) 
      }
      result += `</${node.nodeName}>`
      return result
    }
  
    document.addEventListener('DOMContentLoaded', () => {
      var top = document.getElementById('Top')
      var defs = new Set()
      var treeNode = {}
      collectDefs(top, defs, treeNode) 

      var defsNodes = []
      for (var id of defs) {
        var node = document.getElementById(id)
        var defTreeNode = {}
        convertDef(node, defTreeNode)
        defsNodes.push(defTreeNode)
      }

      var typeCount = {}
      var idMap = {}
      var idProps = []
      const sortedDefs = Array.from(defs)
      var newIDs = []
      sortedDefs.sort()
      for (var id of sortedDefs) {
        var parts = id.split('-')
        var type = parts[0]
        var num = parts[1]
        if (!(type in typeCount)) {
          typeCount[type] = 1
        } else {
          typeCount[type] += 1
        }
        const newID = type + typeCount[type]
        newIDs.push(newID)
        idProps.push(`  private ${newID} = uniqueId('react-${type}-')`)
        idMap[id] = newID
      }

      //console.info('$$$$$', defsNodes)
      // console.info('$$$$$', defsStr)
      // console.info(defs, treeNode)
      treeNode.childNodes.unshift({
        nodeName: 'defs',
        attrs: [],
        childNodes: defsNodes.filter(n => n.nodeName !== 'mask')
      })

      newIDs.sort()
      const dom = outputNode(treeNode, idMap)
      const output = `
import * as React from 'react'
import { uniqueId } from 'lodash'

export default class FIXME extends React.Component {
  ${idProps.join('\n')} 

  render () {
    const { ${newIDs.join(', ')} } = this
    return (
      ${dom}
    )
  }
}

      `
      document.getElementById('output-text').value = output
    })
  
  </script>
</head>

<body>



    <svg width="264px" height="280px" viewBox="0 0 264 280" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <!-- Generator: Sketch 47.1 (45422) - http://www.bohemiancoding.com/sketch -->
      <desc>Created with Sketch.</desc>
      <defs>
          <rect id="path-1" x="0" y="0" width="264" height="280"></rect>
          <path d="M124,144.610951 L124,163 L128,163 L128,163 C167.764502,163 200,195.235498 200,235 L200,244 L0,244 L0,235 C-4.86974701e-15,195.235498 32.235498,163 72,163 L72,163 L76,163 L76,144.610951 C58.7626345,136.422372 46.3722246,119.687011 44.3051388,99.8812385 C38.4803105,99.0577866 34,94.0521096 34,88 L34,74 C34,68.0540074 38.3245733,63.1180731 44,62.1659169 L44,56 L44,56 C44,25.072054 69.072054,5.68137151e-15 100,0 L100,0 L100,0 C130.927946,-5.68137151e-15 156,25.072054 156,56 L156,62.1659169 C161.675427,63.1180731 166,68.0540074 166,74 L166,88 C166,94.0521096 161.51969,99.0577866 155.694861,99.8812385 C153.627775,119.687011 141.237365,136.422372 124,144.610951 Z" id="path-2"></path>
          <path d="M181.544255,32.3304167 C210.784209,41.4878872 232,68.7921987 232,101.051724 L232,110 L32,110 L32,101.051724 C32,68.3969699 53.7388273,40.8195914 83.5340368,32.0020332 C83.182234,33.4201865 83,34.8712315 83,36.3476251 C83,52.6289957 105.161905,65.8276544 132.5,65.8276544 C159.838095,65.8276544 182,52.6289957 182,36.3476251 C182,34.9849859 181.844766,33.6439396 181.544255,32.3304167 Z" id="path-4"></path>
          <rect id="path-6" x="0" y="0" width="264" height="280"></rect>
          <path d="M105.017591,94.1296214 C101.150441,99.7213834 98.257542,95.9467308 94.1374777,92.8762163 C91.6567227,91.0272796 87.9608129,88.7275108 84.5044337,88.8410391 C81.0477114,88.7275108 77.3518016,91.0272796 74.8710466,92.8762163 C70.7509822,95.9467308 67.8580835,99.7213834 63.9909333,94.1296214 C61.0884259,89.9323547 62.3028943,82.8739117 65.014944,78.9027173 C68.8738581,73.2512381 74.1088724,75.9847769 79.9622738,75.3400279 C81.5538829,75.1648137 83.1526985,74.7228407 84.5044337,74 C85.856169,74.7228407 87.4546414,75.1648137 89.0462504,75.3400279 C94.899995,75.9847769 100.134666,73.2512381 103.993923,78.9027173 C106.70563,82.8739117 107.920098,89.9323547 105.017591,94.1296214 M140.39109,26 C136.966521,40.0748212 135.393023,54.4337754 132.909944,68.6711471 C132.392536,71.6390145 131.826063,74.5963095 131.224594,77.5496398 C131.098329,78.1697764 130.973781,80.4725746 130.362704,80.7643064 C128.511632,81.6484223 124.739149,76.9466834 123.730409,75.8851496 C121.196893,73.219256 118.684993,70.5292442 115.599415,68.437233 C109.364783,64.2102603 102.065485,61.7108818 94.4700836,61.117837 C91.2922091,60.8693859 86.9951134,61.3025234 84.000116,63.1104016 C81.0051185,61.3025234 76.7080229,60.8693859 73.5298053,61.117837 C65.9344039,61.7108818 58.6351055,64.2102603 52.4004739,68.437233 C49.3148957,70.5292442 46.8033387,73.219256 44.2694796,75.8851496 C43.2607395,76.9466834 39.4882573,81.6484223 37.6371849,80.7643064 C37.0261079,80.4725746 36.9015594,78.1697764 36.7752954,77.5496398 C36.1738255,74.5963095 35.6073527,71.6390145 35.0899445,68.6711471 C32.6072086,54.4337754 31.0337113,40.0748212 27.6091415,26 C26.6127533,26 25.7385119,44.7478165 25.6273446,46.4945731 C25.174784,53.5889755 24.6463963,60.5254529 25.3216346,67.6261326 C26.485803,79.8749043 27.6993791,95.2339402 37.032627,104.58753 C45.4659003,113.039493 57.7103052,114.806417 68.2713185,120.141327 C69.631059,120.828202 71.4347824,121.676306 73.3798667,122.37111 C75.4289129,123.934171 79.4926946,125 84.1740722,125 C89.0846465,125 93.3155222,123.827456 95.2540874,122.137856 C96.9548781,121.49261 98.5180822,120.752874 99.7285704,120.141327 C110.288776,114.805245 122.533989,113.039493 130.967262,104.58753 C140.30051,95.2339402 141.514086,79.8749043 142.678597,67.6261326 C143.353493,60.5254529 142.825105,53.5889755 142.372887,46.4945731 C142.261377,44.7478165 141.387136,26 140.39109,26 Z" id="path-8"></path>
          <path d="M183.679824,38.9488198 C189.086072,33.9985622 190.387393,23.9615454 187.317704,17.4493246 C183.549263,9.45385312 175.901319,8.45217737 168.572342,11.9686703 C161.664469,15.2835661 155.515175,16.3878671 147.950196,14.7817319 C140.691624,13.2406923 133.805566,10.5226172 126.303388,10.0762471 C113.978028,9.34292483 102.003367,13.914565 93.6031232,23.1292512 C92.0003538,24.8871655 90.7089493,26.8971594 89.4882796,28.9343872 C88.5115454,30.5644351 87.4105298,32.3133822 86.9950459,34.1921885 C86.7973853,35.0855929 87.165272,37.2898774 86.7203704,38.0218712 C86.2391099,38.8123183 84.4244668,39.5373375 83.6510124,40.1238625 C82.0842713,41.3125222 80.7267597,42.6539573 79.4713836,44.1710842 C76.8052796,47.3926541 75.3376994,50.7577001 74.1034777,54.7428152 C70.0005333,67.9877849 69.6528094,83.7412616 74.9569218,96.7467724 C75.6639385,98.4811062 77.8550622,102.098564 79.1431613,98.3847912 C79.3976741,97.6508047 78.8086588,95.1907873 78.8099809,94.4501584 C78.8146084,91.7300906 80.3160587,73.7213568 86.857084,63.6330196 C88.9862338,60.3491948 98.8298903,48.0522456 100.840541,47.9536058 C101.9058,49.6464245 112.720532,60.4624529 140.783385,59.1948919 C153.445253,58.6229725 163.18265,52.9341181 165.520833,50.4680909 C166.549375,56.0008881 178.51323,64.2839965 180.33625,67.6921976 C185.602529,77.5376948 186.770677,97.9957204 188.780988,97.9573368 C190.791299,97.9189532 192.234429,92.7197798 192.647929,91.7270713 C195.719601,84.351669 196.242509,75.0948338 195.914948,67.1684434 C195.487565,56.9663626 191.276535,45.9419513 183.679824,38.9488198 Z" id="path-10"></path>
          <filter x="-0.8%" y="-2.0%" width="101.5%" height="108.0%" filterUnits="objectBoundingBox" id="filter-12">
              <feOffset dx="0" dy="2" in="SourceAlpha" result="shadowOffsetOuter1"></feOffset>
              <feColorMatrix values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.16 0" type="matrix" in="shadowOffsetOuter1" result="shadowMatrixOuter1"></feColorMatrix>
              <feMerge>
                  <feMergeNode in="shadowMatrixOuter1"></feMergeNode>
                  <feMergeNode in="SourceGraphic"></feMergeNode>
              </feMerge>
          </filter>
      </defs>
      <g id="How-To-Use" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
          <g transform="translate(-825.000000, -1100.000000)" id="Avataaar/Default">
              <g transform="translate(825.000000, 1100.000000)">
                  <g id="Rectangle">
                      <use fill="#D8D8D8" fill-rule="evenodd" xlink:href="#path-1"></use>
                      <rect stroke="#979797" stroke-width="1" x="0.5" y="0.5" width="263" height="279"></rect>
                  </g>
                  <g id="Body" stroke-width="1" fill-rule="evenodd" transform="translate(32.000000, 36.000000)">
                      <mask id="mask-3" fill="white">
                          <use xlink:href="#path-2"></use>
                      </mask>
                      <use fill="#D0C6AC" xlink:href="#path-2"></use>
                      <g id="Skin/👶🏽-03-Brown" mask="url(#mask-3)" fill="#D08B5B">
                          <g transform="translate(-32.000000, 0.000000)" id="Color">
                              <rect x="0" y="0" width="264" height="244"></rect>
                          </g>
                      </g>
                      <path d="M156,79 L156,102 C156,132.927946 130.927946,158 100,158 C69.072054,158 44,132.927946 44,102 L44,79 L44,94 C44,124.927946 69.072054,150 100,150 C130.927946,150 156,124.927946 156,94 L156,79 Z" id="Neck-Shadow" fill-opacity="0.100000001" fill="#000000" mask="url(#mask-3)"></path>
                  </g>
                  <g id="Clothing/Shirt-Scoop-Neck" transform="translate(0.000000, 170.000000)">
                      <mask id="mask-5" fill="white">
                          <use xlink:href="#path-4"></use>
                      </mask>
                      <use id="Clothes" fill="#E6E6E6" fill-rule="evenodd" xlink:href="#path-4"></use>
                      <g id="Color/Palette/Gray-01" mask="url(#mask-5)" fill-rule="evenodd" fill="#E6E6E6">
                          <rect id="🖍Color" x="0" y="0" width="264" height="110"></rect>
                      </g>
                  </g>
                  <g id="Face" stroke-width="1" fill-rule="evenodd" transform="translate(76.000000, 82.000000)" fill="#000000">
                      <g id="Mouth/Default" transform="translate(2.000000, 52.000000)" fill-opacity="0.699999988">
                          <path d="M40,15 C40,22.7319865 46.2680135,29 54,29 L54,29 C61.7319865,29 68,22.7319865 68,15" id="Mouth"></path>
                      </g>
                      <g id="Nose/Default" transform="translate(28.000000, 40.000000)" fill-opacity="0.16">
                          <path d="M16,8 C16,12.418278 21.372583,16 28,16 L28,16 C34.627417,16 40,12.418278 40,8" id="Nose"></path>
                      </g>
                      <g id="Eyes/Default-😀" transform="translate(0.000000, 8.000000)" fill-opacity="0.599999964">
                          <circle id="Eye" cx="30" cy="22" r="6"></circle>
                          <circle id="Eye" cx="82" cy="22" r="6"></circle>
                      </g>
                      <g id="Eyebrow/Outline/Default" fill-opacity="0.599999964">
                          <g id="I-Browse" transform="translate(12.000000, 6.000000)">
                              <path d="M3.63024536,11.1585767 C7.54515501,5.64986673 18.2779197,2.56083721 27.5230268,4.83118046 C28.5957248,5.0946055 29.6788665,4.43856013 29.9422916,3.36586212 C30.2057166,2.2931641 29.5496712,1.21002236 28.4769732,0.94659732 C17.7403633,-1.69001789 5.31209962,1.88699832 0.369754639,8.84142326 C-0.270109626,9.74178291 -0.0589363917,10.9903811 0.84142326,11.6302454 C1.74178291,12.2701096 2.9903811,12.0589364 3.63024536,11.1585767 Z" id="Eyebrow" fill-rule="nonzero"></path>
                              <path d="M61.6302454,11.1585767 C65.545155,5.64986673 76.2779197,2.56083721 85.5230268,4.83118046 C86.5957248,5.0946055 87.6788665,4.43856013 87.9422916,3.36586212 C88.2057166,2.2931641 87.5496712,1.21002236 86.4769732,0.94659732 C75.7403633,-1.69001789 63.3120996,1.88699832 58.3697546,8.84142326 C57.7298904,9.74178291 57.9410636,10.9903811 58.8414233,11.6302454 C59.7417829,12.2701096 60.9903811,12.0589364 61.6302454,11.1585767 Z" id="Eyebrow" fill-rule="nonzero" transform="translate(73.000154, 6.039198) scale(-1, 1) translate(-73.000154, -6.039198) "></path>
                          </g>
                      </g>
                  </g>
                  <g id="Top" stroke-width="1" fill-rule="evenodd">
                      <mask id="mask-7" fill="white">
                          <use xlink:href="#path-6"></use>
                      </mask>
                      <g id="Mask"></g>
                      <g id="Top/Short-Hair/Short-Waved" mask="url(#mask-7)">
                          <g transform="translate(-1.000000, 0.000000)">
                              <g id="Facial-Hair/Beard-Medium" stroke="none" fill="none" transform="translate(49.000000, 72.000000)">
                                  <mask id="mask-9" fill="white">
                                      <use xlink:href="#path-8"></use>
                                  </mask>
                                  <use id="Beardness" fill="#252E32" fill-rule="evenodd" xlink:href="#path-8"></use>
                                  <g id="Color/Hair/Brown" mask="url(#mask-9)" fill-rule="evenodd" fill="#724133">
                                      <rect id="Color" x="0" y="0" width="168" height="152"></rect>
                                  </g>
                              </g>
                              <mask id="mask-11" fill="white">
                                  <use xlink:href="#path-10"></use>
                              </mask>
                              <use id="Short-Hair" stroke="none" fill="#28354B" fill-rule="evenodd" xlink:href="#path-10"></use>
                              <g id="Color/Hair/Brown" stroke="none" fill="none" mask="url(#mask-11)" fill-rule="evenodd">
                                  <g transform="translate(1.000000, 0.000000)" id="Color" fill="#724133">
                                      <rect x="0" y="0" width="264" height="280"></rect>
                                  </g>
                              </g>
                              <g id="Top/_Resources/Kurt" stroke="none" fill="none" mask="url(#mask-11)" stroke-width="1" fill-rule="evenodd">
                                  <g transform="translate(62.000000, 85.000000)" id="Kurts">
                                      <g filter="url(#filter-12)" transform="translate(5.000000, 2.000000)">
                                          <path d="M66,11.1111111 C54.9625586,11.1111111 53.3705645,2.0266011 30.6705882,0.740740741 C7.98552275,-0.283199952 0.815225204,6.4494855 0.776470588,11.1111111 C0.813236892,15.4042795 -0.352293566,26.5612661 14.3647059,39.6296296 C29.1367705,55.1420807 44.2704162,49.8818301 49.6941176,44.8148148 C55.1352081,42.4731118 61.3403442,21.4596351 66,21.4814815 C70.6596558,21.5033279 76.8647919,42.4731118 82.3058824,44.8148148 C87.7295838,49.8818301 102.86323,55.1420807 117.635294,39.6296296 C132.352294,26.5612661 131.186763,15.4042795 131.223529,11.1111111 C131.184775,6.4494855 124.014477,-0.283199952 101.329412,0.740740741 C78.6294355,2.0266011 77.0374414,11.1111111 66,11.1111111 Z" id="It!" fill="#F4F4F4" fill-rule="nonzero"></path>
                                          <path d="M55.1294118,21.4814815 C55.5103632,13.8233491 42.2156493,5.64243259 27.9529412,5.92592593 C13.6973442,6.22450879 11.8417942,15.3786982 11.6470588,18.8888889 C11.2982286,27.0220633 20.014463,45.3037598 36.1058824,44.8148148 C52.1972736,44.305848 54.9092435,26.5344305 55.1294118,21.4814815 Z" id="Did" fill="#2F383B" fill-rule="nonzero"></path>
                                          <path d="M120.352941,21.4814815 C120.733893,13.8233491 107.439179,5.64243259 93.1764706,5.92592593 C78.9208736,6.22450879 77.0653236,15.3786982 76.8705882,18.8888889 C76.521758,27.0220633 85.2379924,45.3037598 101.329412,44.8148148 C117.420803,44.305848 120.132773,26.5344305 120.352941,21.4814815 Z" id="Courtney" fill="#2F383B" fill-rule="nonzero" transform="translate(98.611765, 25.370370) scale(-1, 1) translate(-98.611765, -25.370370) "></path>
                                      </g>
                                  </g>
                              </g>
                          </g>
                      </g>
                  </g>
              </g>
          </g>
      </g>
  </svg>

<textarea id='output-text'></textarea>

</body>
</html>